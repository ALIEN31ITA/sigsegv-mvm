# vim: set sts=2 ts=8 sw=2 tw=99 et ft=python:
import os, sys

projectName = 'sigsegv'

# smsdk_ext.cpp will be automatically added later
sourceFiles = [
  'src/common.h',
  os.path.join(Extension.sm_root, 'public', 'asm', 'asm.c'),
  'src/sm/detours.cpp',
  'src/sm/MemoryUtils.cpp',
  'src/sdk2013/debugoverlay_shared.cpp',
  'src/common.cpp',
  'src/sizeof.cpp',
  'src/extension.cpp',
  'src/gameconf.cpp',
  'src/library.cpp',
  'src/addr/addr.cpp',
  'src/addr/prescan.cpp',
  'src/addr/misc.cpp',
  'src/addr/vtable.cpp',
  'src/addr/nextbot.cpp',
  'src/mem/patch.cpp',
  'src/mem/scan.cpp',
  'src/prop.cpp',
  'src/util/trace.cpp',
  'src/util/backtrace.cpp',
  'src/util/rtti.cpp',
  'src/stub/baseentity.cpp',
  'src/stub/gamerules.cpp',
  'src/stub/misc.cpp',
  'src/stub/nav.cpp',
  'src/stub/path.cpp',
  'src/stub/populators.cpp',
  'src/stub/tfplayer.cpp',
  'src/stub/tfbot.cpp',
  'src/link/link.cpp',
  'src/link/nextbot1.cpp',
  'src/link/nextbot2.cpp',
  'src/mod.cpp',
  'src/mod/mod_autocollectspawncredits.cpp',
  'src/mod/mod_engienopush.cpp',
  'src/mod/mod_sniperchargeuncap.cpp',
  'src/mod/mod_stickypusher.cpp',
  'src/mod/mod_robottickle.cpp',
  'src/mod/mod_botmulticlassitem.cpp',
  'src/mod/mod_robotheadnoslide.cpp',
  'src/mod/visualize_airblastbox.cpp',
  'src/mod/visualize_deflectcylinder.cpp',
  'src/mod/visualize_ehsphere.cpp',
]

###############
# Make sure to edit PackageScript, which copies your files to their appropriate locations
# Simple extensions do not need to modify past this point.

project = Extension.HL2Project(builder, projectName + '.ext')

if os.path.isfile(os.path.join(builder.currentSourcePath, 'src', 'sdk', 'smsdk_ext.cpp')):
  # Use the copy included in the project
  project.sources += [os.path.join('src', 'sdk', 'smsdk_ext.cpp')]
else:
  # Use the copy included with SM 1.6 and newer
  project.sources += [os.path.join(Extension.sm_root, 'public', 'smsdk_ext.cpp')]

project.sources += sourceFiles

for sdk_name in Extension.sdks:
  sdk = Extension.sdks[sdk_name]
  
  binary = Extension.HL2Config(project, projectName + '.ext.' + sdk.ext, sdk)


binary.compiler.cflags += [ '-include', 'common.h' ]

binary.compiler.linkflags += [ '-lunwind', '-lunwind-x86', '-liberty' ]

Extension.extensions = builder.Add(project)
